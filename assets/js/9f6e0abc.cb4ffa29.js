"use strict";(self.webpackChunkcspr_docs_redux=self.webpackChunkcspr_docs_redux||[]).push([[69401],{2116:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"local-setup","title":"Setting Up a Local Casper v2.0 Network for Development","description":"How to set up a local Casper v2.0 Network for Development using CCTL and the Rust Casper client.","source":"@site/condor/local-setup.md","sourceDirName":".","slug":"/local-setup","permalink":"/condor/local-setup","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"v2","permalink":"/condor/tags/v-2"},{"inline":true,"label":"setup","permalink":"/condor/tags/setup"}],"version":"current","frontMatter":{"title":"Setting Up a Local Casper v2.0 Network for Development","description":"How to set up a local Casper v2.0 Network for Development using CCTL and the Rust Casper client.","slug":"local-setup","date":"2024-07-16T18:00","authors":["sczembor"],"tags":["v2","setup"],"hide_table_of_contents":false},"sidebar":"condorSidebar","previous":{"title":"JSON RPC Changes in Casper 2.0","permalink":"/condor/jsonrpc"},"next":{"title":"Transactions in Casper 2.0","permalink":"/condor/transactions"}}');var c=s(74848),t=s(28453);const a={title:"Setting Up a Local Casper v2.0 Network for Development",description:"How to set up a local Casper v2.0 Network for Development using CCTL and the Rust Casper client.",slug:"local-setup",date:"2024-07-16T18:00",authors:["sczembor"],tags:["v2","setup"],hide_table_of_contents:!1},i="Setting Up a Local Casper 2.0 Network for Development",l={},o=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Part 1: The Dockerized NCTL (Network Control Tool)",id:"part-1-the-dockerized-nctl-network-control-tool",level:2},{value:"Part 2: Casper Client (Rust)",id:"part-2-casper-client-rust",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Using the Casper Client",id:"using-the-casper-client",level:2},{value:"Accessing the NCTL Block Web Explorer",id:"accessing-the-nctl-block-web-explorer",level:2},{value:"Important Notes",id:"important-notes",level:2},{value:"Additional Tips",id:"additional-tips",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"setting-up-a-local-casper-20-network-for-development",children:"Setting Up a Local Casper 2.0 Network for Development"})}),"\n",(0,c.jsx)(n.p,{children:"Casper 2.0 is a major upgrade to the Casper Network. This guide walks you through creating a local environment for testing and development using Dockerized NCTL and the Rust Casper Client."}),"\n",(0,c.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Docker installed and running on your machine"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"part-1-the-dockerized-nctl-network-control-tool",children:"Part 1: The Dockerized NCTL (Network Control Tool)"}),"\n",(0,c.jsx)(n.p,{children:"NCTL is your tool for managing the Casper network. We'll use a Dockerized version for easier setup."}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Clone the Repository:"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/make-software/casper-nctl-docker.git\ncd casper-nctl-docker\n"})}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Switch to the 2.0 Branch:"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"git checkout feat-2.0\n"})}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["Clone the ",(0,c.jsx)(n.code,{children:"casper-node"})," Repository:"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/casper-network/casper-node.git\ncd casper-node\ngit checkout release-2.0.0-rc3\n"})}),"\n",(0,c.jsxs)(n.p,{children:["Ensure you're in the ",(0,c.jsx)(n.code,{children:"casper-nctl-docker"})," directory when running this command"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Build the Docker Image:"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"docker build -f casper-nctl-condor.Dockerfile -t casper-nctl:rc3 .\n"})}),"\n",(0,c.jsx)(n.p,{children:"This may take a while"}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Verify the Image:"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"docker image ls\n"})}),"\n",(0,c.jsxs)(n.p,{children:["Look for the ",(0,c.jsx)(n.code,{children:"casper-nctl:rc3"})," image in the output"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"REPOSITORY                 TAG        IMAGE ID       CREATED        SIZE\ncasper-nctl                rc3        9fd1e7b25d42   40 hours ago   433MB\n"})}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Start the NCTL Docker Container:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Docker Compose (Recommended):"})," If you're using the ",(0,c.jsx)(n.code,{children:"docker-compose.yml"})," file, make sure that  the ",(0,c.jsx)(n.code,{children:"image"})," under the ",(0,c.jsx)(n.code,{children:"mynctl"})," service points to ",(0,c.jsx)(n.code,{children:"casper-nctl:rc3"}),". Then run ",(0,c.jsx)(n.code,{children:"docker-compose up"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Manual Docker Command:"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"docker run -d --name mynctl -p 11101:11101 casper-nctl:rc3\n"})}),"\n",(0,c.jsx)(n.p,{children:"Once it is up and running you should see that there are 5 nodes and 5 sidecars running and another 5 nodes and 5 sidecars that are inactive:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:" casper-nctl  | validators-1:casper-net-1-node-1       RUNNING   pid 996, uptime 0:00:03\n casper-nctl  | validators-1:casper-net-1-node-2       RUNNING   pid 998, uptime 0:00:03\n casper-nctl  | validators-1:casper-net-1-node-3       RUNNING   pid 1002, uptime 0:00:03\n casper-nctl  | validators-1:casper-net-1-sidecar-1    RUNNING   pid 997, uptime 0:00:03\n casper-nctl  | validators-1:casper-net-1-sidecar-2    RUNNING   pid 1000, uptime 0:00:03\n casper-nctl  | validators-1:casper-net-1-sidecar-3    RUNNING   pid 1011, uptime 0:00:03\n casper-nctl  | validators-2:casper-net-1-node-4       RUNNING   pid 1082, uptime 0:00:02\n casper-nctl  | validators-2:casper-net-1-node-5       RUNNING   pid 1084, uptime 0:00:02\n casper-nctl  | validators-2:casper-net-1-sidecar-4    RUNNING   pid 1083, uptime 0:00:02\n casper-nctl  | validators-2:casper-net-1-sidecar-5    RUNNING   pid 1085, uptime 0:00:02\n casper-nctl  | validators-3:casper-net-1-node-10      STOPPED   Not started\n casper-nctl  | validators-3:casper-net-1-node-6       STOPPED   Not started\n casper-nctl  | validators-3:casper-net-1-node-7       STOPPED   Not started\n casper-nctl  | validators-3:casper-net-1-node-8       STOPPED   Not started\n casper-nctl  | validators-3:casper-net-1-node-9       STOPPED   Not started\n casper-nctl  | validators-3:casper-net-1-sidecar-10   STOPPED   Not started\n casper-nctl  | validators-3:casper-net-1-sidecar-6    STOPPED   Not started\n casper-nctl  | validators-3:casper-net-1-sidecar-7    STOPPED   Not started\n casper-nctl  | validators-3:casper-net-1-sidecar-8    STOPPED   Not started\n casper-nctl  | validators-3:casper-net-1-sidecar-9    STOPPED   Not started\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"part-2-casper-client-rust",children:"Part 2: Casper Client (Rust)"}),"\n",(0,c.jsx)(n.p,{children:"To interact with your local Casper 2.0 network, we'll use the Casper Client. You have two options for using the Casper Client:"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Option 1: Using the Casper Client from the Docker Image"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["The ",(0,c.jsx)(n.code,{children:"casper-nctl:rc3"})," Docker image already includes the ",(0,c.jsx)(n.code,{children:"casper-client"}),"."]}),"\n",(0,c.jsx)(n.li,{children:"You can skip the next two steps if you want to use the pre-installed client."}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Option 2: Using Your Local Casper Client"})}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Clone the Repository (Optional):"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/casper-ecosystem/casper-client-rs.git\ncd casper-client-rs\n"})}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Switch to the Casper 2.0-Compatible Branch  (Optional):"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"git checkout feat-track-node-2.0\n"})}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Activate NCTL scripts:"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"source nctl-activate.sh casper-nctl\n"})}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["4 ",(0,c.jsx)(n.strong,{children:"Test Your Setup:"})]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"nctl-view-node-status\n"})}),"\n",(0,c.jsx)(n.p,{children:"This command should return the status of all the nodes running in your local network, indicating a successful setup. The output should look similar to this:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:'------------------------------------------------------------------------------------------------------------------------------------\n2024-07-10T15:31:42.181535 [INFO] [2043] NCTL :: node #1 :: status:\n{\n"api_version": "2.0.0",\n"peers": [\n   {\n      "node_id": "tls:05b5..7b39",\n      "address": "127.0.0.1:22103"\n   },\n   {\n      "node_id": "tls:527e..37d2",\n      "address": "127.0.0.1:22105"\n   },\n   {\n      "node_id": "tls:b1d0..870f",\n      "address": "127.0.0.1:22102"\n   },\n   {\n      "node_id": "tls:dcdf..e348",\n      "address": "127.0.0.1:22104"\n   }\n],\n"build_version": "2.0.0-d5c0d238f",\n"chainspec_name": "casper-net-1",\n"starting_state_root_hash": "2d92cf9f3ff3eb70f40be598b61cbf747c1b5ea67df9596d84a88c5458028a80",\n"last_added_block_info": {\n   "hash": "c1056e0e5978e725777f48e4488462d7794e6547f25b1fbcc4ba261ca2864395",\n   "timestamp": "2024-07-10T15:31:38.601Z",\n   "era_id": 19,\n   "height": 205,\n   "state_root_hash": "6c5502c3443f526e943fa5a5421349e938464c063c8dd0ada616c997e3805612",\n   "creator": "0190664e16a17594ed2d0e3c279c4cf5894e8db0da15e3b91c938562a1caae32ab"\n},\n"our_public_signing_key": "01fed662dc7f1f7af43ad785ba07a8cc05b7a96f9ee69613cfde43bc56bec1140b",\n"round_length": "4s 96ms",\n"next_upgrade": null,\n"uptime": "13m 15s",\n"reactor_state": "Validate",\n"last_progress": "2024-07-10T15:18:26.354Z",\n"available_block_range": {\n   "low": 0,\n   "high": 205\n},\n"block_sync": {\n   "historical": null,\n   "forward": null\n},\n"latest_switch_block_hash": "5192198c783ed8b66e206c37b34c5e268c84be2f4b78dd9899eecf5f37fb9f68"\n}\n.\n.\n.\n'})}),"\n",(0,c.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"If sidecars or nodes are not running:"})," If you see ",(0,c.jsx)(n.code,{children:"null"})," values under each node in the output of ",(0,c.jsx)(n.code,{children:"nctl-view-node-status"}),", it means the version of ",(0,c.jsx)(n.code,{children:"casper-sidecar"})," is not compatible with the ",(0,c.jsx)(n.code,{children:"casper-node"}),"."]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["Go to the ",(0,c.jsx)(n.code,{children:"casper-node/ci/ci.json"})," file."]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["Change the ",(0,c.jsx)(n.code,{children:"casper-sidecar"})," branch under ",(0,c.jsx)(n.code,{children:"external_deps"})," from:"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'"branch": "feat-2.0"\n'})}),"\n",(0,c.jsx)(n.p,{children:"to:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'"branch": "release-1.0.0rc2_node-2.0.0rc3" \n'})}),"\n",(0,c.jsxs)(n.p,{children:["This is because the ",(0,c.jsx)(n.code,{children:"casper-node"})," we are using is ",(0,c.jsx)(n.code,{children:"release-2.0.0-rc3"}),". The required combination of versions of ",(0,c.jsx)(n.code,{children:"casper-sidecar"})," and ",(0,c.jsx)(n.code,{children:"casper-node"})," may change in the future (rc4 etc.)."]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["Rebuild the NCTL image: ",(0,c.jsx)(n.code,{children:"docker build -f casper-nctl-condor.Dockerfile -t casper-nctl:rc3 ."})]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"using-the-casper-client",children:"Using the Casper Client"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Command Format(Using local casper-client):"})," ",(0,c.jsx)(n.code,{children:"cargo run --release [command] --node-address http://127.0.0.1:11101"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Command Format(Using casper-client from the docker image):"})," ",(0,c.jsx)(n.code,{children:"casper-client [command] --node-address http://127.0.0.1:11101"})]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"accessing-the-nctl-block-web-explorer",children:"Accessing the NCTL Block Web Explorer"}),"\n",(0,c.jsx)(n.p,{children:"The NCTL Docker setup includes a web-based block explorer.  You can access it in your browser at:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"http://127.0.0.1:8080\n"})}),"\n",(0,c.jsx)(n.p,{children:"This allows you to visually explore blocks, transactions, and other details of your local network."}),"\n",(0,c.jsx)(n.h2,{id:"important-notes",children:"Important Notes"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Work in Progress:"})," Casper 2.0 compatibility is still evolving. Some features may be unstable or incomplete."]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"additional-tips",children:"Additional Tips"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Community Resources:"})," Join the ",(0,c.jsx)(n.a,{href:"https://t.me/CSPRCondor",children:"Casper Telegram"})," for help and discussion."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>i});var r=s(96540);const c={},t=r.createContext(c);function a(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:a(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);